# Internationalization (i18n) Design

## Overview

Add multi-language support to Classroom Focus Tracker using next-intl. The app will support Dutch (nl), Spanish (es), and English (en), with automatic browser language detection and Dutch as the default fallback.

## Decisions

| Decision | Choice |
|----------|--------|
| Library | next-intl |
| URL strategy | No prefix (cookie-based) |
| Languages | nl, es, en |
| Default language | Browser detection, fallback to nl |
| Language selector | Header (next to profile) |

## File Structure

```
src/
├── i18n/
│   ├── config.ts          # Locales configuration
│   ├── request.ts         # getRequestConfig for next-intl
│   └── messages/
│       ├── en.json        # English dictionary
│       ├── es.json        # Spanish dictionary
│       └── nl.json        # Dutch dictionary
├── middleware.ts          # Language detection & cookie management
└── components/
    └── LanguageSelector.tsx
```

## Dictionary Structure

```json
{
  "common": {
    "loading": "Loading...",
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "create": "Create",
    "search": "Search",
    "noResults": "No results found",
    "error": "An error occurred",
    "success": "Success",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next",
    "close": "Close"
  },
  "sidebar": {
    "dashboard": "Dashboard",
    "library": "Library",
    "schedule": "Schedule",
    "reports": "Reports"
  },
  "dashboard": {
    "welcome": "Hello, {name}",
    "manageClasses": "Manage your classes and monitor student progress.",
    "liveNow": "Live Now",
    "myClasses": "My Classes",
    "newGroup": "New Group",
    "groupName": "Group Name",
    "noGroups": "No groups",
    "noGroupsDescription": "Create your first class group to start monitoring your students.",
    "createGroup": "Create Group",
    "students": "{count, plural, =0 {No students} =1 {1 student} other {# students}}",
    "viewSession": "View Session",
    "quickLinks": "Quick Links",
    "manageResources": "Manage resources and lessons",
    "scheduleClasses": "Schedule your classes",
    "comingSoon": "Coming soon"
  },
  "lessons": {
    "title": "Library",
    "newLesson": "New Lesson",
    "lessonTitle": "Lesson Title",
    "description": "Description",
    "exercises": "Exercises",
    "resources": "Resources",
    "noLessons": "No lessons",
    "noLessonsDescription": "Create your first lesson to get started.",
    "createLesson": "Create Lesson"
  },
  "calendar": {
    "title": "Schedule",
    "today": "Today",
    "week": "Week",
    "month": "Month",
    "newClass": "New Class",
    "selectGroup": "Select group",
    "selectLesson": "Select lesson",
    "startTime": "Start time",
    "endTime": "End time",
    "noClasses": "No classes scheduled",
    "noClassesDescription": "Schedule your first class to get started."
  },
  "session": {
    "live": "Live",
    "ended": "Ended",
    "startSession": "Start Session",
    "endSession": "End Session",
    "students": "Students",
    "focused": "Focused",
    "distracted": "Distracted",
    "away": "Away",
    "content": "Content",
    "raiseHand": "Raise Hand",
    "lowerHand": "Lower Hand",
    "handRaised": "Hand Raised",
    "waitingForContent": "Waiting for content...",
    "teacherWillShare": "The teacher will share content soon."
  },
  "auth": {
    "signIn": "Sign In",
    "signOut": "Sign Out",
    "studentLogin": "Student Login",
    "enterCode": "Enter session code",
    "enterName": "Enter your name",
    "joinSession": "Join Session",
    "invalidCode": "Invalid session code",
    "sessionNotFound": "Session not found"
  },
  "groups": {
    "title": "Group",
    "students": "Students",
    "addStudent": "Add Student",
    "studentName": "Student Name",
    "noStudents": "No students",
    "noStudentsDescription": "Add students to this group.",
    "deleteGroup": "Delete Group",
    "deleteGroupConfirm": "Are you sure you want to delete this group? This action cannot be undone."
  }
}
```

## Integration

### next-intl Configuration

```typescript
// src/i18n/config.ts
export const locales = ['nl', 'es', 'en'] as const;
export type Locale = (typeof locales)[number];
export const defaultLocale: Locale = 'nl';

// src/i18n/request.ts
import { getRequestConfig } from 'next-intl/server';
import { cookies } from 'next/headers';
import { defaultLocale, locales, type Locale } from './config';

export default getRequestConfig(async () => {
  const cookieStore = await cookies();
  const localeCookie = cookieStore.get('locale')?.value;
  const locale = locales.includes(localeCookie as Locale)
    ? localeCookie as Locale
    : defaultLocale;

  return {
    locale,
    messages: (await import(`./messages/${locale}.json`)).default
  };
});
```

### Middleware

```typescript
// src/middleware.ts
- Read Accept-Language header for new users
- Check/set 'locale' cookie
- No URL rewriting needed
```

### Usage in Components

```tsx
// Client Components
'use client';
import { useTranslations } from 'next-intl';

function Dashboard() {
  const t = useTranslations('dashboard');
  return <h1>{t('welcome', { name: 'Pablo' })}</h1>;
}

// Server Components
import { getTranslations } from 'next-intl/server';

async function ServerPage() {
  const t = await getTranslations('dashboard');
  return <h1>{t('welcome', { name: 'Pablo' })}</h1>;
}
```

### Language Selector

Located in Header, next to SignOutButton:

```tsx
// src/components/LanguageSelector.tsx
- Dropdown showing current locale (NL/ES/EN)
- On change: set cookie and router.refresh()
- Visual flags optional for quick identification
```

## Migration Order

1. **Setup** - Install next-intl, create config, add Provider
2. **Common components** - EmptyState, ConfirmModal, StatusBadge
3. **Layout** - Sidebar, Header, add LanguageSelector
4. **Dashboard pages** - dashboard/page.tsx, lessons, calendar
5. **Group pages** - groups/[groupId], students
6. **Session pages** - sessions/[sessionId], class view
7. **Student login** - student/login, class/session

## Namespaces

| Namespace | Content |
|-----------|---------|
| common | Buttons, states, generic messages |
| sidebar | Main navigation |
| dashboard | Main page, groups overview |
| lessons | Library, lessons, exercises |
| calendar | Schedule, scheduled classes |
| session | Live session (teacher and student) |
| auth | Login, logout |
| groups | Group management, students |
